# P. 矩阵乘法

### 思路和解法：

把一个矩阵分解为两个点 $L$ 和 $R$，那么由于矩阵的存在，两个点之间存在一条边。

对于题中要求的合法矩阵序列，其实就是合法点序列。

而Eular通路和Eular回路按照定义就恰好能够，所有边走一次且仅有一次，即一笔画问题。

那么使用Eular定理解题。



前提条件：连通性。这部分可以使用并查集判定。

分支：Eular回路。此时我们可以选择任意一个矩阵作为开始和结尾，存在一个最大值的选择。全部点出入度相等。

分支：Eular通路。此时开始和结束固定，求出即可。开始点即出度比入度大一，结束点入度比出度大一，其余相等。



具体看代码，有注释

### 时间复杂度：

并查集判连通性$O(Nlog(N))$

处理Eular回路和Eular通路$O(N)$

故总时间复杂度$O(Nlog(N))$

### 空间复杂度：

$O(N)$