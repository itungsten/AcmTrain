# P.   近战法师暴击好累

### 思路和解法：

既然说是DP专题了，题目中又出现了**相邻**，可以说是很裸的区间DP了。

但是和平时不一样的是，按照题解里面的做法，相比普通DP，多了一个value数组用于储存区间被合并为一个点时的数值。

值得注意的是，实际上，给定一个区间，这个value是给定的。通过对区间长度归纳，这个结论是不难证明的。一个思路就是一个区间要有value值，那么必须分为两个有同样value值的子区间，而这样子区间的划分法只有一个。

那么实际上value数组就可以现求，但是这样的做法显然foolish，所以说，这道题不仅覆盖了区间DP，还启发我们可以通过使用辅助数组帮助DP。



那么DP基操：

**状态表示** ：$dp[l][r]$ 表示[l,r]需要的暴击数目，$val[l][r]$ 表示 $dp[l][r]=1$ 时的对应数组

**状态转移**：

$\forall k \in[l,r) $
$$
if\;(dp[l][k]=dp[k+1][r]=1 \and val[l][k]=val[k+1][r]) \quad dp[l][r]=1 \;\; val[l][r]=val[l][k]+1 \\
else\quad dp[l][r]=max(dp[l][r],dp[l][k]+dp[k+1][r])
$$
**初始状态**：

$\forall i \in [1,n] \quad dp[i][i]=1 \quad val[i][i]=array[i] $

**递推顺序**：

子区间长度一定被原区间小，那么按照区间长度从小到大枚举



细节看代码，有注释。

### 时间复杂度：

枚举区间长度$O(N)$

枚举区间左端点$O(N)$

枚举子区间分界点$O(N)$

故总的时间复杂度为$O(N^3)$

### 空间复杂度：

区间DP嘛

$O(N^2)$