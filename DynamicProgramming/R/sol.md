# R.   君の名前は？唱：“达拉崩吧斑得贝迪卜多比鲁翁” Ⅱ

需要注意的是，数据范围大了，不仅要加数组长度，还要考虑爆int

一个好的习惯是统一使用signed main()，这样可以省心使用#define int long避免爆int，但是需要注意printf的%d相应改为%ld

~~（以下部分全部复制G题）~~

### 思路和解法：

非常裸的背包问题（但是我不会5555），然后去看了背包九讲233333

问题分为两部分，多重背包和泛化物品。



第一部分是多重背包。

多重背包有三种实现方案：1.暴力拆分 2.二进制拆分 3.单调队列优化

由于题解中说二进制优化能够解此题，甚至比单调队列快，就学了二进制拆分。（因为二进制拆分理解起来简单，实现起来方便，单调队列半天看不懂）x  

二进制拆分的核心思想就是 数的加法基本对应二进制的或运算，这样就把暴力的N个物品变成了log(N)个物品。



第二部分是泛化物品，要理解泛化物品首先就要明白分组背包。分组背包就是物品之间有排斥关系（这是一种等价关系）的背包，这样的关系对集合划分的结果就是一堆组。实际上，01背包，多重背包都可以看作是特殊的分组背包。这里不加赘述和优化（实际上，由数据可以看出，m很小）。



***那么实际上，我们可以把它看作是，一共有（n+m）组物品，前n组里面各有$\log(D_i)$件物品，后m组各有 c 件物品的一个分组背包问题。***

（一个坑点：题目中神奇物品可能在体积为0时，价值不为0）

具体看代码，有注释

### 时间复杂度：

分两部分考虑

普通物品二进制拆分部分$O(NC\log(D))$

神奇物品转化为分组问题暴力计算$O(MC^2)$

故总复杂度$O(NC\log(D)+MC^2)$

### 空间复杂度：

DP的空间复杂度一般都在记忆化上啦

$O(c)$