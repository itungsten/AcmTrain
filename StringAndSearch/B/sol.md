# B. 第二章：北境之王的现身

### 思路和解法：

首先给字符串处理出一个kmp自动机，也就是找出它的转移函数。

然后的做法其实有点像非确定性有穷自动机，也就是说维护一个幂集。虽然这里不是集合的01，即状态的存在与否，而是状态的数目多少。

该自动机有m个阶段，每个阶段随机读入一个字符，然后各状态相应进行状态转移，最后统计达到接受状态的自动机数目即可。



注意事项：

1.空间问题，蛮干会MLE（~~编译不过~~），发现每个阶段只需要前一个阶段的结果，就可以滚动数组。需要注意的是，滚动数组需要清空。

2.记得乘上后缀积，因为按照定义，已经匹配完成的，不需要考虑后面的取值，只需要按照乘法原理即可。同样需要注意一下，n的后缀积要特别设为1



具体看代码，有详细注释

### 时间复杂度：

KMP自动机预处理$O(N)$

后缀积预处理$O(M)$

DP模拟部分$O(MN)$

总时间复杂度$O(MN)$

### 空间复杂度：

11MiB

存储状态转移函数$O(N)$

滚动的各阶段状态数目统计$O(N)$

后缀积数组$O(M)$

总复杂度$O(N+M)$