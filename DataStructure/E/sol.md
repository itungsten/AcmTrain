# E. 哪个男孩不想挖最多的矿呢

### 题意理解：

INPUT：

第一组 两个正整数 N,M，表示矿坑矩阵的行列
第二组 NxM的矩阵，元素是对应矿坑的开采系数

OUTPUT:

第一行 一次能够开采矿坑的最大数目。
第二行 最大情况下合适起始点的个数。

### 思路和解法：

整除问题转换最大公倍数，如果开采中心点的系数等于四周包括自己的gcd，那么就是合法的。

（让我们看看tag x）对于gcd这样的可重复贡献问题，可以考虑使用st表。但是这里的数据是二维的，那么就用二维st表咯。然后一维是用两个区间倍增合并，二维就用四个小矩形倍增合并咯（k维就$2^k$个子块倍增合并咯，逃）

关于最值，因为我们知道上下界，而且我们知道小数不行必然大数不行，具有传递性，那么可以使用二分。

具体看代码，有注释

### 时间复杂度：

懒得分析太细，记K=max(n,m)

1.打表花费$O(K^2log(K))$

2.二分次数近似$\log(K)$,每次近似$K^2$,那么总计也是$O(K^2log(K))$

3.最后求合适的开采点个数近似$K^2$

故总的复杂度为$O(K^2log(K))$

### 空间复杂度：

主要是表的空间

$O(K^2\log(K))$