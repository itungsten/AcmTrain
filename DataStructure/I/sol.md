# I.   利姆露与魔法元素

### 题意理解：

INPUT：

第一组 元素种数 n，观测条数 k，操作次数 m。

第二组 k行观测数据；

第三组 m次操作

OUTPUT:

所有询问操作对应答案

### 思路和解法：

通过tag-带权并查集了解完该数据结构后，并做了板题后，发现这不就是poj食物链套了个马甲?。

普通的并查集和带权并查集还是有用途上的区别，主要是表示的意义的原因。

普通并查集在一个集合表示一类，带权并查集在一个集合表示具有相对关系，并且我们在union的时候也要维护好相对关系。

但是并查集都是并，没有删除诶，难道要用可持久化数据结构，Xm退群算了。

等等，tag里面还有离线，离线啥意思呢？大概就是程序一开始就知道所有输入，把所有输入保存起来，进行加工之后再输出。

そして,我们先把操作记录下来，然后倒着操作，就把删除转化为常见的并了。

这里有一个坑，（出题人出来背锅x）就是可能删除多次，依照题意，我们可以维护一个isDelete数组之类的东西，如果isDelete为false，那么就是删除并记录，再把isDelete改成true，否则忽略。

细节看代码，有详细注释。

顺便吐槽一下，之前实现离线是用的vector，然后很奇妙地WA了，后来改成数组就过了

对于，我得出两点结论：

1.越简单越不容易出错

2.我不会用vector

### 时间复杂度：

只使用了路径压缩的并查集，单次操作复杂度为$O(\log(N))$,那么操作的总时间复杂度为$O(M\log(N))$

当然里面有必要的初始化$O(N)$,那么总复杂度为

$O(M\log(N)+N)$

### 空间复杂度：

离线操作和观测条目需要空间

$O( N + M+K)$