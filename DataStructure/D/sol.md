# D.  利姆露的魔法序列

### 题意理解：

INPUT：

第一行 操作数目n
第二行 n个操作，每个操作一个字符

OUTPUT:

一行答案，空格隔开。依次表示该次操作后产生的序列对应的是一个成功魔法（输出魔法的强度）还是一个失败魔法（输出 -1）。

### 思路和解法：

首先，考虑到可以左右移动，考虑极限情况，全部左移或全部右移，那么就需要至少左右都留出N的空间，即空间翻倍。

读写的位置考虑一个`pos`变量记录。

显然，我们需要对该数据进行单点修改，区间查询。

单点修改，区间查询，最简单是树状数组，但是树状数组看起来这里有点力不从心，支持不了这麽丰富的功能（可能是我写不出来x），加上tag是线段树，那就线段树了，然后又要开4倍空间，一共8倍空间。

大佬说线段树要考虑三个问题：

线段树维护什么，有区间可加性吗？

lazy标记可不可以快速更新被维护的值？

lazy标记可不可以快速下传和合并？

然后这里没有区间修改，关于lazy，它死了。

那么答案是：

线段树维护最大前缀和（最大层数），最小前缀和（合法性），区间和（合法性）

具体看代码，有注释

### 时间复杂度：

$O(n\log(n))$

### 空间复杂度：

$O(n)$