# Y.  诶，我和你讲这瓜超休闲的

### 思路和解法：

ppt上的解法实在看不懂，这里是异或差分。

使用异或差分的需要知道两个很重要的性质

$1.x \oplus x=0$

$2.x \oplus 0=x$

然后就可以开始了。

依题意，我们要能够区间修改，区间查询。好了，依照我现在的知识，不是线段树就是分块（看tag和题解，它就是线段树x

那么我们考虑使用线段树解决问题。

区间修改是要区间异或，而区间查询是要求查询组合种类。

没有学过的人是很难（不可能x）想到要用一个叫线性基的东西的。

线性基，类比矢量基，能够用线性基的大小描述空间的维度，如果线性基的大小为 $n$,那么组合数就为 $ 2^n$。

那么我们就要快速查询区间线性基的大小，当然就要维护区间线性基了。

幸运的是，线性基具有区间可加性，合并方式为动态插入法（不赘述了

然而如果直接维护原来的序列的线性基，你会发现你需要区间修改，而且更新会很痛苦（你需要把被更新节点的线性基全部异或，生成新的线性基）

这样，我们考虑差分序列

$$b[i]=a[i] \oplus a[i+1]$$

由性质1

不难看出

$$a[l],a[l+1],\cdots,a[r]  \Leftrightarrow a[l],b[l],\cdots,b[r-1]$$

即这两个线性基等价。

如果我们维护差分序列，那么就是单点修改（双点修改x），区间查询（查询 l 到 r-1 ），再把a[l]插入基中即可。

然而a[l]也在变化，所以我们还要维护a[l],这里使用树状数组

细节看代码，代码有详细注释

### 时间复杂度：

单次线段树点修改和区间查询操作复杂度$O( \; (\log(N)^3\;)$

树状数组修改，查询$O(\log(N))$

建树$O(\sum N)$

总复杂度$O(\sum N+(\sum M)\log(N)^3)$

### 空间复杂度：

$O( N )$