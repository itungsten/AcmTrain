# H.   c波的游戏I

### 题意理解：

INPUT：

第一行，节点数 n和模数 k。
第二行，n个整数，各节点的初始数值。
第三行，操作次数 m。
后m行，目标区间 [l,r] 、目标值 c、区间增量 d。

OUTPUT:

*m* 行，每行一个整数，表示目标区间 [l,r] 在模k的意义下等于目标值 c的节点个数。

### 思路和解法：

像这种区间修改和区间查询的问题首先想到线段树，然后发现并没有什么区间可加性。

然后题目说正解没有log，那就不是在树上做，考虑根号算法（其实是看tag x），使用分块（优雅暴力），发现复杂度没啥问题。

那么就把区间按照$\sqrt{N}$划分，不能恰好划分，补一块即可。

区间修改时，对于整块的区间，在lazy上修改，其余暴力直接修改值。

区间查询时，综合lazy和暂未被更新的值即可，需要注意的是，为了保证整块的询问是$O(1)$，还需要为整块维护一个块内数字模k余数的统计。

详细见代码，有注释。

### 时间复杂度：

用均值不等式不难证明，分块区间划分为$\sqrt{N}$为最优，此时单次修改和查询复杂度都是$O(\sqrt{N})$

故主体为$O(M\sqrt{N})$

当然还有必要的初始化$O(N)$

故总时间为$O(M\sqrt{N}+N)$

（我怎么知道M会不会为0呢，逃x

### 空间复杂度：

$O( N )$